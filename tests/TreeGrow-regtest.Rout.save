
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.2.0  (2005-10-06 r35749)
ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> 
> set.seed(290875)
> gctorture(on = FALSE)
> library(party)
Loading required package: survival
Loading required package: splines
Loading required package: grid
Loading required package: modeltools
Loading required package: coin
Loading required package: mvtnorm
> if (!require(ipred))
+     stop("cannot load package ipred")
Loading required package: ipred
Loading required package: rpart
Loading required package: MASS
Loading required package: mlbench
Loading required package: nnet
Loading required package: class
> if (!require(coin))
+     stop("cannot load package coin")
> gctorture(on = GCtorture)
> 
> ### get rid of the NAMESPACE
> load(file.path(.find.package("party"), "R", "all.rda"))
> 
> gtctrl <- new("GlobalTestControl")
> tlev <- levels(gtctrl@testtype)
> 
> data(GlaucomaM, package = "ipred")
> tree <- ctree(Class ~ ., data = GlaucomaM)@tree
> stopifnot(isequal(tree[[5]][[3]], 0.059))
> 
> # print(tree)
> 
> stump <- ctree(Class ~ ., data = GlaucomaM, 
+                control = ctree_control(stump = TRUE))
> print(stump)

	 Conditional tree with 2 terminal nodes

Response:  Class 
Inputs:  ag, at, as, an, ai, eag, eat, eas, ean, eai, abrg, abrt, abrs, abrn, abri, hic, mhcg, mhct, mhcs, mhcn, mhci, phcg, phct, phcs, phcn, phci, hvc, vbsg, vbst, vbss, vbsn, vbsi, vasg, vast, vass, vasn, vasi, vbrg, vbrt, vbrs, vbrn, vbri, varg, vart, vars, varn, vari, mdg, mdt, mds, mdn, mdi, tmg, tmt, tms, tmn, tmi, mr, rnf, mdic, emd, mv 
Number of observations:  196 

1) vari <= 0.059; criterion = 1, statistic = 71.475
  2)*  weights = 87 
1) vari > 0.059
  3)*  weights = 109 
> 
> data(treepipit, package = "coin")
> 
> tr <- ctree(counts ~ ., data = treepipit)
> tr

	 Conditional tree with 2 terminal nodes

Response:  counts 
Inputs:  age, coverstorey, coverregen, meanregen, coniferous, deadtree, cbpiles, ivytree, fdist 
Number of observations:  86 

1) coverstorey <= 40; criterion = 0.998, statistic = 13.678
  2)*  weights = 24 
1) coverstorey > 40
  3)*  weights = 62 
> plot(tr)
> 
> 
> data(GlaucomaM, package = "ipred")
> 
> tr <- ctree(Class ~ ., data = GlaucomaM)
> tr

	 Conditional tree with 4 terminal nodes

Response:  Class 
Inputs:  ag, at, as, an, ai, eag, eat, eas, ean, eai, abrg, abrt, abrs, abrn, abri, hic, mhcg, mhct, mhcs, mhcn, mhci, phcg, phct, phcs, phcn, phci, hvc, vbsg, vbst, vbss, vbsn, vbsi, vasg, vast, vass, vasn, vasi, vbrg, vbrt, vbrs, vbrn, vbri, varg, vart, vars, varn, vari, mdg, mdt, mds, mdn, mdi, tmg, tmt, tms, tmn, tmi, mr, rnf, mdic, emd, mv 
Number of observations:  196 

1) vari <= 0.059; criterion = 1, statistic = 71.475
  2) vasg <= 0.046; criterion = 1, statistic = 29.265
    3) vart <= 0.005; criterion = 0.999, statistic = 18.185
      4)*  weights = 51 
    3) vart > 0.005
      5)*  weights = 22 
  2) vasg > 0.046
    6)*  weights = 14 
1) vari > 0.059
  7)*  weights = 109 
> plot(tr)
> 
> data(GBSG2, package = "ipred")  
> 
> GBSG2tree <- ctree(Surv(time, cens) ~ ., data = GBSG2)
> GBSG2tree

	 Conditional tree with 4 terminal nodes

Response:  Surv(time, cens) 
Inputs:  horTh, age, menostat, tsize, tgrade, pnodes, progrec, estrec 
Number of observations:  686 

1) pnodes <= 3; criterion = 1, statistic = 56.156
  2) horTh == {no}; criterion = 0.965, statistic = 8.113
    3)*  weights = 248 
  2) horTh == {yes}
    4)*  weights = 128 
1) pnodes > 3
  5) progrec <= 20; criterion = 0.999, statistic = 14.941
    6)*  weights = 144 
  5) progrec > 20
    7)*  weights = 166 
> plot(GBSG2tree)
> plot(GBSG2tree, terminal_panel = node_surv(GBSG2tree))
> survfit(Surv(time, cens) ~ as.factor(GBSG2tree@where), data = GBSG2)
Call: survfit(formula = Surv(time, cens) ~ as.factor(GBSG2tree@where), 
    data = GBSG2)

                               n events median 0.95LCL 0.95UCL
as.factor(GBSG2tree@where)=3 248     88   2093    1814     Inf
as.factor(GBSG2tree@where)=4 128     31    Inf    2372     Inf
as.factor(GBSG2tree@where)=6 144    103    624     525     797
as.factor(GBSG2tree@where)=7 166     77   1701    1174    2018
> names(GBSG2)
 [1] "horTh"    "age"      "menostat" "tsize"    "tgrade"   "pnodes"  
 [7] "progrec"  "estrec"   "time"     "cens"    
> 
> tr <- ctree(Surv(time, cens) ~ ., data = GBSG2, 
+             control = ctree_control(teststattype = "maxabs", 
+                                     testtype = "Raw"))
> tr

	 Conditional tree with 10 terminal nodes

Response:  Surv(time, cens) 
Inputs:  horTh, age, menostat, tsize, tgrade, pnodes, progrec, estrec 
Number of observations:  686 

1) pnodes <= 3; criterion = 1, statistic = 7.494
  2) horTh == {no}; criterion = 0.996, statistic = 2.848
    3) menostat == {Post}; criterion = 0.978, statistic = 2.286
      4)*  weights = 112 
    3) menostat == {Pre}
      5) age <= 37; criterion = 1, statistic = 3.858
        6)*  weights = 21 
      5) age > 37
        7)*  weights = 115 
  2) horTh == {yes}
    8) progrec <= 74; criterion = 0.975, statistic = 2.241
      9)*  weights = 73 
    8) progrec > 74
      10)*  weights = 55 
1) pnodes > 3
  11) progrec <= 20; criterion = 1, statistic = 3.865
    12) pnodes <= 9; criterion = 0.991, statistic = 2.612
      13)*  weights = 87 
    12) pnodes > 9
      14)*  weights = 57 
  11) progrec > 20
    15) horTh == {no}; criterion = 0.976, statistic = 2.251
      16)*  weights = 101 
    15) horTh == {yes}
      17) menostat == {Post}; criterion = 0.965, statistic = 2.105
        18)*  weights = 45 
      17) menostat == {Pre}
        19)*  weights = 20 
> plot(tr)
> 
> data(mammoexp)
> attr(mammoexp$ME, "scores") <- 1:3   
> attr(mammoexp$SYMPT, "scores") <- 1:4
> attr(mammoexp$DECT, "scores") <- 1:3 
> names(mammoexp)[names(mammoexp) == "SYMPT"] <- "symptoms"
> names(mammoexp)[names(mammoexp) == "PB"] <- "benefit"
> 
> names(mammoexp)
[1] "ME"       "symptoms" "benefit"  "HIST"     "BSE"      "DECT"    
> tr <- ctree(ME ~ ., data = mammoexp)
Warning message:
no admissible split found 
> tr

	 Conditional tree with 3 terminal nodes

Response:  ME 
Inputs:  symptoms, benefit, HIST, BSE, DECT 
Number of observations:  412 

1) symptoms <= Agree; criterion = 1, statistic = 29.933
  2)*  weights = 113 
1) symptoms > Agree
  3) benefit <= 8; criterion = 0.988, statistic = 9.17
    4)*  weights = 208 
  3) benefit > 8
    5)*  weights = 91 
> plot(tr)
> 
> 
